# éƒ¨ç½²å’Œä½¿ç”¨æŒ‡å—

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/kecan/solidity_learn.git
cd solidity_learn
```

### 2. å®‰è£…ä¾èµ–

```bash
npm install
```

### 3. å¯åŠ¨æœ¬åœ°åŒºå—é“¾

åœ¨æ–°çš„ç»ˆç«¯çª—å£ä¸­è¿è¡Œï¼š

```bash
npm run ganache
```

è¿™å°†å¯åŠ¨ä¸€ä¸ªæœ¬åœ°çš„ä»¥å¤ªåŠæµ‹è¯•ç½‘ç»œï¼Œé»˜è®¤ç«¯å£ä¸º 8545ã€‚

### 4. ç¼–è¯‘æ™ºèƒ½åˆçº¦

```bash
npm run compile
```

### 5. éƒ¨ç½²æ™ºèƒ½åˆçº¦

```bash
npm run migrate
```

éƒ¨ç½²æˆåŠŸåï¼Œä½ ä¼šçœ‹åˆ°ç±»ä¼¼çš„è¾“å‡ºï¼š
```
2_deploy_redpacket.js
=====================

   Deploying 'RedPacket'
   ---------------------
   > transaction hash:    0x...
   > contract address:    0x5FbDB2315678afecb367f032d93F642f64180aa3
   > account:             0xf39Fd6e51aad88F6F4ce6aB8827279cffFb92266
   > balance:             99.99...
   > gas used:            1234567
   > gas price:           20 gwei
   > value sent:          0 ETH
   > total cost:          0.01... ETH
```

**é‡è¦**: å¤åˆ¶ `contract address` å¹¶æ›´æ–°å‰ç«¯ä»£ç ä¸­çš„åˆçº¦åœ°å€ã€‚

### 6. æ›´æ–°å‰ç«¯åˆçº¦åœ°å€

ç¼–è¾‘ `client/app.js` æ–‡ä»¶ï¼Œå°†ç¬¬ 3 è¡Œçš„åˆçº¦åœ°å€æ›¿æ¢ä¸ºå®é™…éƒ¨ç½²çš„åœ°å€ï¼š

```javascript
const CONTRACT_ADDRESS = '0x5FbDB2315678afecb367f032d93F642f64180aa3'; // æ›¿æ¢ä¸ºå®é™…åœ°å€
```

### 7. å¯åŠ¨å‰ç«¯

```bash
cd client
npm install
npm start
```

å‰ç«¯å°†åœ¨ http://localhost:3000 å¯åŠ¨ã€‚

## ğŸ”§ MetaMask é…ç½®

### æ·»åŠ æœ¬åœ°ç½‘ç»œ

1. æ‰“å¼€ MetaMask
2. ç‚¹å‡»ç½‘ç»œä¸‹æ‹‰èœå•
3. é€‰æ‹© "æ·»åŠ ç½‘ç»œ"
4. è¾“å…¥ä»¥ä¸‹ä¿¡æ¯ï¼š
   - ç½‘ç»œåç§°: `Ganache Local`
   - RPC URL: `http://127.0.0.1:8545`
   - é“¾ID: `1337`
   - è´§å¸ç¬¦å·: `ETH`

### å¯¼å…¥æµ‹è¯•è´¦æˆ·

Ganache å¯åŠ¨æ—¶ä¼šæ˜¾ç¤º 10 ä¸ªæµ‹è¯•è´¦æˆ·å’Œç§é’¥ï¼Œé€‰æ‹©ä¸€ä¸ªå¯¼å…¥åˆ° MetaMaskï¼š

1. ç‚¹å‡» MetaMask å³ä¸Šè§’å¤´åƒ
2. é€‰æ‹© "å¯¼å…¥è´¦æˆ·"
3. ç²˜è´´ç§é’¥
4. ç‚¹å‡» "å¯¼å…¥"

## ğŸ“± ä½¿ç”¨è¯´æ˜

### åˆ›å»ºçº¢åŒ…

1. è¿æ¥é’±åŒ…
2. è¾“å…¥çº¢åŒ…é‡‘é¢ï¼ˆETHï¼‰
3. è®¾ç½®çº¢åŒ…ä¸ªæ•°ï¼ˆ1-10ï¼‰
4. å¡«å†™ç¥ç¦è¯­
5. ç‚¹å‡» "åˆ›å»ºçº¢åŒ…"
6. ç¡®è®¤ MetaMask äº¤æ˜“
7. è·å¾—çº¢åŒ…IDï¼Œåˆ†äº«ç»™æœ‹å‹

### æŠ¢çº¢åŒ…

1. è¾“å…¥çº¢åŒ…ID
2. ç‚¹å‡» "æŸ¥è¯¢çº¢åŒ…" æŸ¥çœ‹ä¿¡æ¯
3. ç¡®è®¤çº¢åŒ…å¯ç”¨
4. ç‚¹å‡» "æŠ¢çº¢åŒ…"
5. ç¡®è®¤ MetaMask äº¤æ˜“
6. è·å¾—éšæœºé‡‘é¢

## ğŸ§ª è¿è¡Œæµ‹è¯•

```bash
npm run test
```

æµ‹è¯•å°†éªŒè¯ï¼š
- çº¢åŒ…åˆ›å»ºåŠŸèƒ½
- æŠ¢çº¢åŒ…åŠŸèƒ½
- é˜²é‡å¤æŠ¢å¤º
- æƒé™æ§åˆ¶

## ğŸ“ åˆçº¦åŠŸèƒ½

### ä¸»è¦å‡½æ•°

- `createRedPacket(uint256 _count, string _message)` - åˆ›å»ºçº¢åŒ…
- `claimRedPacket(uint256 _redPacketId)` - æŠ¢çº¢åŒ…
- `getRedPacketInfo(uint256 _redPacketId)` - æŸ¥è¯¢çº¢åŒ…ä¿¡æ¯
- `hasClaimedRedPacket(uint256 _redPacketId, address _user)` - æŸ¥è¯¢æ˜¯å¦å·²æŠ¢
- `deposit()` - ç‹¬ç«‹å­˜æ¬¾å‡½æ•°

### äº‹ä»¶

- `RedPacketCreated` - çº¢åŒ…åˆ›å»ºäº‹ä»¶
- `RedPacketClaimed` - çº¢åŒ…è¢«æŠ¢äº‹ä»¶

## ğŸ”’ å®‰å…¨ç‰¹æ€§

- **é˜²é‡å¤æŠ¢å¤º**: æ¯ä¸ªåœ°å€åªèƒ½æŠ¢ä¸€æ¬¡
- **æƒé™æ§åˆ¶**: åˆ›å»ºè€…ä¸èƒ½æŠ¢è‡ªå·±çš„çº¢åŒ…
- **æ•°é‡é™åˆ¶**: çº¢åŒ…ä¸ªæ•°é™åˆ¶ä¸º 1-10 ä¸ª
- **çŠ¶æ€ç®¡ç†**: çº¢åŒ…çŠ¶æ€è‡ªåŠ¨ç®¡ç†

## ğŸ› å¸¸è§é—®é¢˜

### 1. åˆçº¦éƒ¨ç½²å¤±è´¥

- ç¡®ä¿ Ganache æ­£åœ¨è¿è¡Œ
- æ£€æŸ¥ `truffle-config.js` ä¸­çš„ç½‘ç»œé…ç½®

### 2. MetaMask è¿æ¥å¤±è´¥

- ç¡®ä¿ MetaMask ç½‘ç»œè®¾ç½®æ­£ç¡®
- æ£€æŸ¥ RPC URL å’Œç«¯å£å·

### 3. äº¤æ˜“å¤±è´¥

- ç¡®ä¿è´¦æˆ·æœ‰è¶³å¤Ÿçš„ ETH
- æ£€æŸ¥ gas è´¹ç”¨è®¾ç½®

### 4. å‰ç«¯æ— æ³•è¿æ¥åˆçº¦

- ç¡®è®¤åˆçº¦åœ°å€å·²æ­£ç¡®æ›´æ–°
- æ£€æŸ¥ ABI æ˜¯å¦åŒ¹é…

## ğŸ“‚ é¡¹ç›®ç»“æ„

```
solidity_learn/
â”œâ”€â”€ contracts/          # æ™ºèƒ½åˆçº¦æºç 
â”‚   â”œâ”€â”€ Migrations.sol
â”‚   â””â”€â”€ RedPacket.sol
â”œâ”€â”€ migrations/         # éƒ¨ç½²è„šæœ¬
â”‚   â”œâ”€â”€ 1_initial_migration.js
â”‚   â””â”€â”€ 2_deploy_redpacket.js
â”œâ”€â”€ test/              # æµ‹è¯•æ–‡ä»¶
â”‚   â””â”€â”€ redpacket.test.js
â”œâ”€â”€ client/            # å‰ç«¯ç•Œé¢
â”‚   â”œâ”€â”€ index.html
â”‚   â”œâ”€â”€ app.js
â”‚   â””â”€â”€ package.json
â”œâ”€â”€ truffle-config.js  # Truffle é…ç½®
â””â”€â”€ package.json       # é¡¹ç›®é…ç½®
```

## ğŸ”„ å¼€å‘æµç¨‹

1. ä¿®æ”¹æ™ºèƒ½åˆçº¦ (`contracts/RedPacket.sol`)
2. é‡æ–°ç¼–è¯‘: `npm run compile`
3. é‡æ–°éƒ¨ç½²: `npm run migrate --reset`
4. æ›´æ–°å‰ç«¯åˆçº¦åœ°å€
5. æµ‹è¯•åŠŸèƒ½

## ğŸ“š å­¦ä¹ èµ„æº

- [Truffle æ–‡æ¡£](https://www.trufflesuite.com/docs)
- [Solidity æ–‡æ¡£](https://docs.soliditylang.org/)
- [Web3.js æ–‡æ¡£](https://web3js.readthedocs.io/)
- [MetaMask æ–‡æ¡£](https://docs.metamask.io/)